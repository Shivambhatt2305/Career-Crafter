<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Career Crafters - Find Colleges in India</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* Particle Background */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(99, 102, 241, 0.3);
            border-radius: 50%;
            animation: float-particle 15s infinite linear;
        }

        @keyframes float-particle {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            min-height: 70px;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            font-size: clamp(1.2rem, 4vw, 1.8rem);
            font-weight: bold;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-brand i {
            margin-right: 0.5rem;
            font-size: clamp(1.5rem, 4vw, 2rem);
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .search-container {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex: 1;
            max-width: 600px;
            margin: 0 2rem;
        }

        .search-bar {
            display: flex;
            flex: 1;
            position: relative;
        }

        .search-input {
            flex: 1;
            padding: clamp(0.5rem, 2vw, 0.75rem) clamp(0.75rem, 3vw, 1rem);
            border: 2px solid #e2e8f0;
            border-radius: 25px 0 0 25px;
            font-size: clamp(0.9rem, 2vw, 1rem);
            transition: all 0.3s ease;
            outline: none;
        }

        .search-input:focus {
            border-color: #6366f1;
            box-shadow: 0 0 10px rgba(99, 102, 241, 0.2);
        }

        .search-btn {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            border: none;
            padding: clamp(0.5rem, 2vw, 0.75rem) clamp(1rem, 3vw, 1.5rem);
            border-radius: 0 25px 25px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: clamp(0.9rem, 2vw, 1rem);
        }

        .search-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .filter-dropdown {
            position: relative;
        }

        .filter-btn {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            border: none;
            padding: clamp(0.5rem, 2vw, 0.75rem) clamp(1rem, 3vw, 1.5rem);
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: clamp(0.9rem, 2vw, 1rem);
        }

        .filter-btn:hover {
            transform: scale(1.05);
        }

        .filter-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 1rem;
            min-width: 200px;
            display: none;
            z-index: 1001;
        }

        .filter-menu.active {
            display: block;
        }

        .filter-option {
            display: block;
            width: 100%;
            padding: 0.5rem;
            border: none;
            background: none;
            text-align: left;
            cursor: pointer;
            border-radius: 5px;
            transition: background 0.3s ease;
        }

        .filter-option:hover {
            background: #f1f5f9;
        }

        .back-home {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            padding: clamp(0.5rem, 2vw, 0.75rem) clamp(1rem, 3vw, 1.5rem);
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: clamp(0.9rem, 2vw, 1rem);
        }

        .back-home:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        /* Main Content */
        .main-content {
            display: flex;
            padding-top: 90px;
            min-height: 100vh;
            gap: 1rem;
            padding-left: 1rem;
            padding-right: 1rem;
            position: relative;
            z-index: 2;
        }

        /* College List */
        .college-list-container {
            width: 35%;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            backdrop-filter: blur(10px);
            max-height: calc(100vh - 110px);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .list-header {
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e2e8f0;
        }

        .list-title {
            font-size: clamp(1.2rem, 3vw, 1.5rem);
            font-weight: 700;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .college-count {
            color: #64748b;
            font-size: clamp(0.9rem, 2vw, 1rem);
        }

        .api-status {
            font-size: 0.8rem;
            color: #059669;
            margin-top: 0.25rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .college-list {
            flex: 1;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: #6366f1 #f1f5f9;
        }

        .college-list::-webkit-scrollbar {
            width: 6px;
        }

        .college-list::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 3px;
        }

        .college-list::-webkit-scrollbar-thumb {
            background: #6366f1;
            border-radius: 3px;
        }

        .college-item {
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            border: 1px solid #e2e8f0;
            border-radius: 15px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .college-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .college-item:hover {
            background: linear-gradient(135deg, #e0e7ff, #c7d2fe);
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.3);
        }

        .college-item:hover::before {
            transform: scaleY(1);
        }

        .college-item.active {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            transform: translateX(5px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        }

        .college-item.active::before {
            transform: scaleY(1);
            background: #fbbf24;
        }

        .college-name {
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            font-weight: 600;
            margin-bottom: 0.25rem;
            line-height: 1.3;
        }

        .college-location {
            font-size: clamp(0.8rem, 2vw, 0.9rem);
            opacity: 0.8;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .college-type {
            font-size: clamp(0.7rem, 1.8vw, 0.8rem);
            background: rgba(99, 102, 241, 0.1);
            color: #6366f1;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            margin-top: 0.5rem;
            display: inline-block;
        }

        .college-item.active .college-type {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        /* Details Container */
        .details-container {
            width: 65%;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            backdrop-filter: blur(10px);
            max-height: calc(100vh - 110px);
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: #6366f1 #f1f5f9;
        }

        .details-container::-webkit-scrollbar {
            width: 6px;
        }

        .details-container::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 3px;
        }

        .details-container::-webkit-scrollbar-thumb {
            background: #6366f1;
            border-radius: 3px;
        }

        .college-header {
            display: flex;
            align-items: flex-start;
            gap: 1.5rem;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid #e2e8f0;
        }

        .college-image {
            width: 150px;
            height: 100px;
            border-radius: 15px;
            object-fit: cover;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            flex-shrink: 0;
        }

        .college-info {
            flex: 1;
        }

        .college-title {
            font-size: clamp(1.5rem, 4vw, 2rem);
            font-weight: 700;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
            line-height: 1.2;
        }

        .college-details {
            color: #64748b;
            font-size: clamp(0.9rem, 2vw, 1rem);
            line-height: 1.6;
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .detail-icon {
            color: #6366f1;
            width: 16px;
        }

        .section {
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: clamp(1.2rem, 3vw, 1.5rem);
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section-icon {
            color: #6366f1;
            font-size: 1.2rem;
        }

        .section-content {
            color: #64748b;
            line-height: 1.7;
            font-size: clamp(0.9rem, 2vw, 1rem);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }

        .stat-value {
            font-size: clamp(1.2rem, 3vw, 1.5rem);
            font-weight: 700;
            color: #6366f1;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            font-size: clamp(0.8rem, 2vw, 0.9rem);
            color: #64748b;
        }

        .review-card {
            background: #f8fafc;
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            border-left: 4px solid #6366f1;
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .reviewer-name {
            font-weight: 600;
            color: #1e293b;
        }

        .rating {
            color: #fbbf24;
        }

        .review-text {
            color: #64748b;
            font-size: clamp(0.9rem, 2vw, 1rem);
            line-height: 1.6;
        }

        .no-selection {
            text-align: center;
            padding: 3rem;
            color: #64748b;
        }

        .no-selection i {
            font-size: 4rem;
            color: #e2e8f0;
            margin-bottom: 1rem;
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: #64748b;
        }

        .loading i {
            font-size: 2rem;
            color: #6366f1;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Error message */
        .error-message {
            background: #fee2e2;
            color: #b91c1c;
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            border-left: 4px solid #b91c1c;
            font-size: 0.9rem;
        }

        /* Success message */
        .success-message {
            background: #d1fae5;
            color: #065f46;
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            border-left: 4px solid #065f46;
            font-size: 0.9rem;
        }

        /* Tags container */
        .tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .tag {
            background: linear-gradient(135deg, #e0e7ff, #c7d2fe);
            color: #6366f1;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 500;
            border: 1px solid #c7d2fe;
        }

        /* Map container */
        .map-container {
            width: 100%;
            height: 300px;
            border-radius: 15px;
            margin-top: 1rem;
            border: 1px solid #e2e8f0;
            background: #f8fafc;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            text-align: center;
            color: #64748b;
        }

        .map-container i {
            font-size: 3rem;
            color: #6366f1;
            margin-bottom: 1rem;
        }

        /* Mobile Toggle */
        .mobile-toggle {
            display: none;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            margin-bottom: 1rem;
            width: 100%;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .navbar {
                padding: 1rem 1.5rem;
            }
            
            .search-container {
                margin: 0 1rem;
            }
            
            .college-list-container {
                width: 40%;
            }
            
            .details-container {
                width: 60%;
            }
        }

        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                gap: 1rem;
                padding: 1rem;
            }
            
            .search-container {
                width: 100%;
                margin: 0;
            }
            
            .back-home {
                align-self: flex-start;
            }
            
            .main-content {
                flex-direction: column;
                padding-top: 140px;
                gap: 1rem;
            }
            
            .college-list-container {
                width: 100%;
                max-height: 300px;
                order: 2;
            }
            
            .details-container {
                width: 100%;
                max-height: none;
                order: 1;
            }
            
            .mobile-toggle {
                display: block;
            }
            
            .college-list-container.mobile-hidden {
                display: none;
            }
            
            .college-header {
                flex-direction: column;
                text-align: center;
            }
            
            .college-image {
                width: 100%;
                max-width: 300px;
                height: 200px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .map-container {
                height: 250px;
            }
        }

        @media (max-width: 480px) {
            .main-content {
                padding-left: 0.5rem;
                padding-right: 0.5rem;
                padding-top: 160px;
            }
            
            .college-list-container,
            .details-container {
                padding: 1rem;
            }
            
            .college-header {
                gap: 1rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .search-container {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .search-bar {
                width: 100%;
            }
            
            .search-input {
                border-radius: 25px;
            }
            
            .search-btn {
                border-radius: 25px;
                width: 100%;
            }

            .map-container {
                height: 200px;
            }
        }

        /* Touch device optimizations */
        @media (hover: none) and (pointer: coarse) {
            .college-item:hover {
                transform: none;
                background: linear-gradient(135deg, #ffffff, #f8fafc);
            }
            
            .search-btn:hover,
            .filter-btn:hover,
            .back-home:hover {
                transform: none;
            }
        }

        /* Accessibility improvements */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
            
            .particle {
                animation: none;
            }
        }
    </style>
</head>
<body>
    <!-- Particle Background -->
    <div class="particles" id="particles"></div>

    <!-- Header -->
    <header class="header">
        <nav class="navbar">
            <div class="nav-brand">
                <i class="fas fa-graduation-cap"></i>
                <span>Career Crafters</span>
            </div>
            <div class="search-container">
                <div class="search-bar">
                    <input type="text" id="search-input" class="search-input" placeholder="Search colleges by name, city, or state...">
                    <button id="search-btn" class="search-btn">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
                <div class="filter-dropdown">
                    <button id="filter-btn" class="filter-btn">
                        <i class="fas fa-filter"></i> Filter
                    </button>
                    <div id="filter-menu" class="filter-menu">
                        <button class="filter-option" data-filter="all">All Colleges</button>
                        <button class="filter-option" data-filter="university">Universities</button>
                        <button class="filter-option" data-filter="college">Colleges</button>
                        <button class="filter-option" data-filter="institute">Institutes</button>
                        <button class="filter-option" data-filter="school">Schools</button>
                    </div>
                </div>
            </div>
            <a href="index.html" class="back-home">
                <i class="fas fa-arrow-left"></i> Home
            </a>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- College List -->
        <div class="college-list-container" id="college-list-container">
            <div class="list-header">
                <h2 class="list-title">Colleges in India</h2>
                <p class="college-count" id="college-count">Loading colleges...</p>
                <div class="api-status" id="api-status">
                    <i class="fas fa-wifi"></i>
                    <span>Connecting to OpenStreetMap API...</span>
                </div>
            </div>
            <div id="college-list" class="college-list">
                <div class="loading">
                    <i class="fas fa-spinner"></i>
                    <p>Fetching real college data from APIs...</p>
                </div>
            </div>
        </div>

        <!-- College Details -->
        <div class="details-container">
            <button class="mobile-toggle" id="mobile-toggle">
                <i class="fas fa-list"></i> Show College List
            </button>
            <div id="college-details">
                <div class="no-selection">
                    <i class="fas fa-university"></i>
                    <h2 class="list-title">Select a College</h2>
                    <p>Choose a college from the list to view detailed information. Data is fetched live from OpenStreetMap and other educational APIs.</p>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Global variables
        let allColleges = [];
        let filteredColleges = [];
        let currentFilter = 'all';
        let activeCollege = null;
        let currentSearchQuery = '';

        // API endpoints
        const OVERPASS_API = 'https://overpass-api.de/api/interpreter';
        const NOMINATIM_API = 'https://nominatim.openstreetmap.org/search';

        // College type mapping
        const collegeTypeMapping = {
            'university': 'University',
            'college': 'College',
            'institute': 'Institute',
            'school': 'School',
            'iit': 'Engineering',
            'nit': 'Engineering',
            'engineering': 'Engineering',
            'medical': 'Medical',
            'management': 'Management',
            'law': 'Law',
            'arts': 'Arts & Science',
            'science': 'Arts & Science'
        };

        // Create particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = window.innerWidth < 768 ? 25 : 50;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Update API status
        function updateApiStatus(message, isError = false) {
            const statusElement = document.getElementById('api-status');
            statusElement.innerHTML = `
                <i class="fas fa-${isError ? 'exclamation-triangle' : 'wifi'}"></i>
                <span>${message}</span>
            `;
            statusElement.style.color = isError ? '#dc2626' : '#059669';
        }

        // Fetch colleges from Overpass API (OpenStreetMap)
        async function fetchCollegesFromOverpass(query = '', bbox = null) {
            try {
                updateApiStatus('Fetching from OpenStreetMap API...');
                
                // Define bounding box for India
                const indiaBbox = bbox || '6.4627,68.1097,35.5044,97.3953'; // South, West, North, East
                
                // Build Overpass query for educational institutions
                let overpassQuery = `
                    [out:json][timeout:25];
                    (
                        node["amenity"="university"](${indiaBbox});
                        node["amenity"="college"](${indiaBbox});
                        node["amenity"="school"]["school:type"~"higher_education|university"](${indiaBbox});
                        way["amenity"="university"](${indiaBbox});
                        way["amenity"="college"](${indiaBbox});
                        relation["amenity"="university"](${indiaBbox});
                        relation["amenity"="college"](${indiaBbox});
                    );
                    out center meta;
                `;

                // If there's a search query, modify the query
                if (query) {
                    overpassQuery = `
                        [out:json][timeout:25];
                        (
                            node["amenity"~"university|college"]["name"~"${query}",i](${indiaBbox});
                            way["amenity"~"university|college"]["name"~"${query}",i](${indiaBbox});
                            relation["amenity"~"university|college"]["name"~"${query}",i](${indiaBbox});
                        );
                        out center meta;
                    `;
                }

                const response = await fetch(OVERPASS_API, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: `data=${encodeURIComponent(overpassQuery)}`
                });

                if (!response.ok) {
                    throw new Error(`Overpass API error: ${response.status}`);
                }

                const data = await response.json();
                updateApiStatus(`Found ${data.elements.length} colleges from OpenStreetMap`);

                return data.elements.map(element => {
                    const tags = element.tags || {};
                    const lat = element.lat || element.center?.lat;
                    const lon = element.lon || element.center?.lon;
                    
                    // Determine college type
                    let type = 'College';
                    const name = (tags.name || 'Unknown College').toLowerCase();
                    
                    for (const [keyword, collegeType] of Object.entries(collegeTypeMapping)) {
                        if (name.includes(keyword)) {
                            type = collegeType;
                            break;
                        }
                    }

                    // Extract location information
                    const city = tags['addr:city'] || tags.city || extractCityFromName(tags.name) || 'Unknown';
                    const state = tags['addr:state'] || tags.state || 'Unknown';
                    
                    return {
                        id: element.id,
                        name: tags.name || 'Unknown College',
                        city: city,
                        state: state,
                        type: type,
                        amenity: tags.amenity || 'college',
                        website: tags.website || null,
                        phone: tags.phone || null,
                        email: tags.email || null,
                        address: tags['addr:full'] || `${city}, ${state}`,
                        coordinates: lat && lon ? { lat, lon } : null,
                        source: 'OpenStreetMap'
                    };
                }).filter(college => college.name !== 'Unknown College');

            } catch (error) {
                console.error('Overpass API error:', error);
                updateApiStatus('OpenStreetMap API error, trying fallback...', true);
                throw error;
            }
        }

        // Fetch colleges from Nominatim API (fallback)
        async function fetchCollegesFromNominatim(query = 'college') {
            try {
                updateApiStatus('Fetching from Nominatim API...');
                
                const searchQuery = query || 'college university institute';
                const url = `${NOMINATIM_API}?format=json&q=${encodeURIComponent(searchQuery + ' India')}&limit=50&countrycodes=in&addressdetails=1&extratags=1`;
                
                const response = await fetch(url, {
                    headers: {
                        'User-Agent': 'CareerCrafters/1.0 (Educational Purpose)'
                    }
                });

                if (!response.ok) {
                    throw new Error(`Nominatim API error: ${response.status}`);
                }

                const data = await response.json();
                updateApiStatus(`Found ${data.length} results from Nominatim API`);

                return data.filter(item => {
                    const type = item.type?.toLowerCase() || '';
                    const category = item.category?.toLowerCase() || '';
                    return category === 'amenity' && ['university', 'college', 'school'].includes(type);
                }).map(item => {
                    const address = item.address || {};
                    let type = 'College';
                    
                    const name = (item.display_name || 'Unknown College').toLowerCase();
                    for (const [keyword, collegeType] of Object.entries(collegeTypeMapping)) {
                        if (name.includes(keyword)) {
                            type = collegeType;
                            break;
                        }
                    }

                    return {
                        id: item.place_id,
                        name: item.name || item.display_name?.split(',')[0] || 'Unknown College',
                        city: address.city || address.town || address.village || 'Unknown',
                        state: address.state || 'Unknown',
                        type: type,
                        amenity: item.type || 'college',
                        address: item.display_name || 'Unknown',
                        coordinates: {
                            lat: parseFloat(item.lat),
                            lon: parseFloat(item.lon)
                        },
                        source: 'Nominatim'
                    };
                });

            } catch (error) {
                console.error('Nominatim API error:', error);
                updateApiStatus('Nominatim API error', true);
                throw error;
            }
        }

        // Extract city from college name (helper function)
        function extractCityFromName(name) {
            if (!name) return null;
            
            const indianCities = [
                'Delhi', 'Mumbai', 'Bangalore', 'Chennai', 'Kolkata', 'Hyderabad', 'Pune', 'Ahmedabad',
                'Jaipur', 'Lucknow', 'Kanpur', 'Nagpur', 'Indore', 'Bhopal', 'Visakhapatnam', 'Patna',
                'Vadodara', 'Ghaziabad', 'Ludhiana', 'Agra', 'Nashik', 'Faridabad', 'Meerut', 'Rajkot',
                'Kalyan', 'Vasai', 'Varanasi', 'Srinagar', 'Aurangabad', 'Dhanbad', 'Amritsar', 'Navi Mumbai',
                'Allahabad', 'Ranchi', 'Howrah', 'Coimbatore', 'Jabalpur', 'Gwalior', 'Vijayawada', 'Jodhpur',
                'Madurai', 'Raipur', 'Kota', 'Guwahati', 'Chandigarh', 'Solapur', 'Hubli', 'Tiruchirappalli',
                'Bareilly', 'Mysore', 'Tiruppur', 'Gurgaon', 'Aligarh', 'Jalandhar', 'Bhubaneswar', 'Salem'
            ];
            
            for (const city of indianCities) {
                if (name.toLowerCase().includes(city.toLowerCase())) {
                    return city;
                }
            }
            return null;
        }

        // Main fetch function
        async function fetchColleges(query = '') {
            const listContainer = document.getElementById('college-list');
            const countElement = document.getElementById('college-count');
            
            // Show loading state
            listContainer.innerHTML = `
                <div class="loading">
                    <i class="fas fa-spinner"></i>
                    <p>Fetching real college data from APIs...</p>
                </div>
            `;
            
            countElement.textContent = 'Loading colleges...';
            currentSearchQuery = query;
            
            try {
                let colleges = [];
                
                // Try Overpass API first
                try {
                    colleges = await fetchCollegesFromOverpass(query);
                    
                    // If we get few results, try to get more from different regions
                    if (colleges.length < 20 && !query) {
                        updateApiStatus('Getting more colleges from different regions...');
                        
                        // Try major city regions
                        const cityBboxes = [
                            '28.4,77.0,28.8,77.4', // Delhi
                            '18.8,72.7,19.3,73.1', // Mumbai
                            '12.8,77.4,13.2,77.8', // Bangalore
                            '13.0,80.1,13.3,80.3', // Chennai
                            '22.4,88.2,22.7,88.5'  // Kolkata
                        ];
                        
                        for (const bbox of cityBboxes) {
                            try {
                                const cityColleges = await fetchCollegesFromOverpass('', bbox);
                                colleges = colleges.concat(cityColleges);
                                if (colleges.length > 50) break;
                            } catch (error) {
                                console.log('Error fetching from city bbox:', error);
                            }
                        }
                    }
                } catch (error) {
                    console.log('Overpass API failed, trying Nominatim...');
                    colleges = await fetchCollegesFromNominatim(query);
                }
                
                // Remove duplicates based on name and location
                const uniqueColleges = [];
                const seen = new Set();
                
                for (const college of colleges) {
                    const key = `${college.name.toLowerCase()}-${college.city.toLowerCase()}`;
                    if (!seen.has(key)) {
                        seen.add(key);
                        uniqueColleges.push(college);
                    }
                }
                
                // Store all colleges
                allColleges = uniqueColleges;
                
                // Apply filter if needed
                if (currentFilter !== 'all') {
                    filteredColleges = allColleges.filter(college => {
                        if (currentFilter === 'university') {
                            return college.amenity === 'university' || college.name.toLowerCase().includes('university');
                        } else if (currentFilter === 'college') {
                            return college.amenity === 'college' || college.name.toLowerCase().includes('college');
                        } else if (currentFilter === 'institute') {
                            return college.name.toLowerCase().includes('institute');
                        } else if (currentFilter === 'school') {
                            return college.amenity === 'school' || college.name.toLowerCase().includes('school');
                        }
                        return true;
                    });
                } else {
                    filteredColleges = [...allColleges];
                }
                
                // Update count and render
                countElement.textContent = `${filteredColleges.length} colleges found`;
                updateApiStatus(`Successfully loaded ${filteredColleges.length} colleges`);
                
                renderCollegeList();
                
                // Show success message
                if (filteredColleges.length > 0) {
                    showMessage(`Successfully fetched ${filteredColleges.length} colleges from live APIs!`, 'success');
                }
                
            } catch (error) {
                console.error('Error fetching colleges:', error);
                updateApiStatus('All APIs failed. Please try again later.', true);
                
                listContainer.innerHTML = `
                    <div class="error-message">
                        <p><strong>API Error:</strong> Unable to fetch college data from external APIs.</p>
                        <p>Please check your internet connection and try again.</p>
                        <button onclick="fetchColleges('${currentSearchQuery}')" style="margin-top: 1rem; padding: 0.5rem 1rem; background: #6366f1; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            <i class="fas fa-refresh"></i> Retry
                        </button>
                    </div>
                `;
                
                countElement.textContent = '0 colleges found';
            }
        }

        // Show message helper
        function showMessage(message, type = 'success') {
            const listContainer = document.getElementById('college-list');
            const messageDiv = document.createElement('div');
            messageDiv.className = `${type}-message`;
            messageDiv.innerHTML = `<p>${message}</p>`;
            
            listContainer.insertAdjacentElement('beforebegin', messageDiv);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 5000);
        }

        // Render college list
        function renderCollegeList() {
            const listContainer = document.getElementById('college-list');
            
            if (filteredColleges.length === 0) {
                listContainer.innerHTML = `
                    <div class="no-selection">
                        <i class="fas fa-search"></i>
                        <p>No colleges found matching your criteria.</p>
                        <button onclick="fetchColleges('')" style="margin-top: 1rem; padding: 0.5rem 1rem; background: #6366f1; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            <i class="fas fa-refresh"></i> Load All Colleges
                        </button>
                    </div>
                `;
                return;
            }
            
            listContainer.innerHTML = '';
            
            filteredColleges.forEach(college => {
                const collegeItem = document.createElement('div');
                collegeItem.className = 'college-item';
                collegeItem.innerHTML = `
                    <div class="college-name">${college.name}</div>
                    <div class="college-location">
                        <i class="fas fa-map-marker-alt"></i>
                        ${college.city}, ${college.state}
                    </div>
                    <div class="college-type">${college.type}</div>
                `;
                
                collegeItem.addEventListener('click', () => {
                    // Remove active class from all items
                    document.querySelectorAll('.college-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    
                    // Add active class to clicked item
                    collegeItem.classList.add('active');
                    
                    // Display college details
                    displayCollegeDetails(college);
                    
                    // Hide mobile list on selection
                    if (window.innerWidth <= 768) {
                        document.getElementById('college-list-container').classList.add('mobile-hidden');
                        document.getElementById('mobile-toggle').innerHTML = '<i class="fas fa-list"></i> Show College List';
                    }
                });
                
                listContainer.appendChild(collegeItem);
            });
        }

        // Display college details
        function displayCollegeDetails(college) {
            const detailsContainer = document.getElementById('college-details');
            activeCollege = college;
            
            // Show loading state
            detailsContainer.innerHTML = `
                <div class="loading">
                    <i class="fas fa-spinner"></i>
                    <p>Loading college details...</p>
                </div>
            `;
            
            // Simulate loading delay for better UX
            setTimeout(() => {
                // Generate dynamic data based on college type
                const about = `${college.name} is a ${college.type.toLowerCase()} located in ${college.city}, ${college.state}. This institution offers various academic programs and is part of India's educational landscape. The college information is sourced from ${college.source} and provides real-time data about educational institutions across India.`;
                
                // Generate mock reviews
                const reviews = generateMockReviews();
                
                // Generate mock placement data
                const placements = generateMockPlacements(college.type);
                
                // Generate courses based on type
                const courses = generateCourses(college.type);
                
                // Generate facilities
                const facilities = ['Library', 'Computer Labs', 'Sports Complex', 'Cafeteria', 'Wi-Fi Campus', 'Auditorium', 'Hostels', 'Research Labs'];
                
                // Generate college image URL
                const imageUrl = `/placeholder.svg?height=200&width=300&text=${encodeURIComponent(college.name.replace(/\s+/g, '+'))}`;
                
                // Generate HTML for reviews
                const reviewsHtml = reviews.map(review => `
                    <div class="review-card">
                        <div class="review-header">
                            <span class="reviewer-name">${review.student}</span>
                            <span class="rating">${'★'.repeat(Math.floor(review.rating))}${review.rating % 1 ? '☆' : ''}</span>
                        </div>
                        <p class="review-text">${review.comment}</p>
                    </div>
                `).join('');
                
                // Generate HTML for courses
                const coursesHtml = courses.map(course => `<span class="tag">${course}</span>`).join('');
                
                // Generate HTML for facilities
                const facilitiesHtml = facilities.map(facility => `<span class="tag">${facility}</span>`).join('');
                
                // Generate HTML for recruiters
                const recruitersHtml = placements.topRecruiters.map(recruiter => `<span class="tag">${recruiter}</span>`).join('');
                
                // Render college details
                detailsContainer.innerHTML = `
                    <div class="college-header fade-in">
                        <img src="${imageUrl}" alt="${college.name}" class="college-image" onerror="this.src='/placeholder.svg?height=200&width=300&text=College+Image'">
                        <div class="college-info">
                            <h1 class="college-title">${college.name}</h1>
                            <div class="college-details">
                                <div class="detail-item">
                                    <i class="fas fa-map-marker-alt detail-icon"></i>
                                    <span>${college.city}, ${college.state}</span>
                                </div>
                                <div class="detail-item">
                                    <i class="fas fa-graduation-cap detail-icon"></i>
                                    <span>${college.type}</span>
                                </div>
                                <div class="detail-item">
                                    <i class="fas fa-database detail-icon"></i>
                                    <span>Source: ${college.source}</span>
                                </div>
                                ${college.website ? `
                                <div class="detail-item">
                                    <i class="fas fa-globe detail-icon"></i>
                                    <a href="${college.website}" target="_blank" style="color: #6366f1;">${college.website}</a>
                                </div>
                                ` : ''}
                                ${college.phone ? `
                                <div class="detail-item">
                                    <i class="fas fa-phone detail-icon"></i>
                                    <span>${college.phone}</span>
                                </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                    
                    <div class="section fade-in">
                        <h3 class="section-title">
                            <i class="fas fa-info-circle section-icon"></i>
                            About
                        </h3>
                        <div class="section-content">
                            <p>${about}</p>
                        </div>
                    </div>
                    
                    <div class="section fade-in">
                        <h3 class="section-title">
                            <i class="fas fa-chart-bar section-icon"></i>
                            Placement Statistics
                        </h3>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-value">${placements.averagePackage}</div>
                                <div class="stat-label">Average Package</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value">${placements.highestPackage}</div>
                                <div class="stat-label">Highest Package</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value">${placements.placementRate}</div>
                                <div class="stat-label">Placement Rate</div>
                            </div>
                        </div>
                        <div class="section-content">
                            <p><strong>Top Recruiters:</strong></p>
                            <div class="tags-container">
                                ${recruitersHtml}
                            </div>
                        </div>
                    </div>
                    
                    <div class="section fade-in">
                        <h3 class="section-title">
                            <i class="fas fa-book section-icon"></i>
                            Courses Offered
                        </h3>
                        <div class="section-content">
                            <div class="tags-container">
                                ${coursesHtml}
                            </div>
                        </div>
                    </div>
                    
                    <div class="section fade-in">
                        <h3 class="section-title">
                            <i class="fas fa-building section-icon"></i>
                            Facilities
                        </h3>
                        <div class="section-content">
                            <div class="tags-container">
                                ${facilitiesHtml}
                            </div>
                        </div>
                    </div>
                    
                    <div class="section fade-in">
                        <h3 class="section-title">
                            <i class="fas fa-star section-icon"></i>
                            Student Reviews
                        </h3>
                        <div class="section-content">
                            ${reviewsHtml}
                        </div>
                    </div>
                    
                    <div class="section fade-in">
                        <h3 class="section-title">
                            <i class="fas fa-map-marked-alt section-icon"></i>
                            Location
                        </h3>
                        <div class="section-content">
                            <p><strong>Address:</strong> ${college.address}</p>
                            ${college.coordinates ? `
                            <p><strong>Coordinates:</strong> ${college.coordinates.lat.toFixed(6)}, ${college.coordinates.lon.toFixed(6)}</p>
                            ` : ''}
                            <div class="map-container">
                                <i class="fas fa-map-marked-alt"></i>
                                <p style="font-weight: 600; margin-bottom: 0.5rem;">Interactive Map</p>
                                <p>Real location data from ${college.source}</p>
                                ${college.coordinates ? `
                                <p style="font-size: 0.9rem; margin-top: 0.5rem;">
                                    <a href="https://www.google.com/maps?q=${college.coordinates.lat},${college.coordinates.lon}" target="_blank" style="color: #6366f1;">
                                        <i class="fas fa-external-link-alt"></i> View on Google Maps
                                    </a>
                                </p>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }, 800);
        }

        // Generate mock reviews
        function generateMockReviews() {
            const reviewerNames = ['Rahul S.', 'Priya K.', 'Amit R.', 'Sneha G.', 'Vikram P.', 'Neha M.'];
            const reviewComments = [
                'Great faculty and facilities, but campus food could improve.',
                'Excellent academic programs and supportive environment.',
                'Good infrastructure and research opportunities.',
                'Wonderful campus life and diverse student community.',
                'Strong industry connections and placement support.',
                'Beautiful campus with modern facilities and equipment.'
            ];
            
            const reviews = [];
            for (let i = 0; i < 3; i++) {
                reviews.push({
                    student: reviewerNames[Math.floor(Math.random() * reviewerNames.length)],
                    rating: (3.5 + Math.random() * 1.5).toFixed(1),
                    comment: reviewComments[Math.floor(Math.random() * reviewComments.length)]
                });
            }
            return reviews;
        }

        // Generate mock placement data
        function generateMockPlacements(type) {
            let avgPackage, highestPackage, placementRate;
            
            if (type === 'Engineering' || type === 'University') {
                avgPackage = (8 + Math.random() * 12).toFixed(1) + ' LPA';
                highestPackage = (25 + Math.random() * 50).toFixed(1) + ' LPA';
                placementRate = (85 + Math.random() * 10).toFixed(0) + '%';
            } else {
                avgPackage = (4 + Math.random() * 8).toFixed(1) + ' LPA';
                highestPackage = (15 + Math.random() * 20).toFixed(1) + ' LPA';
                placementRate = (70 + Math.random() * 20).toFixed(0) + '%';
            }
            
            const recruiters = ['TCS', 'Infosys', 'Wipro', 'IBM', 'Accenture', 'Amazon', 'Microsoft', 'Google', 'Deloitte', 'EY'];
            const topRecruiters = [];
            for (let i = 0; i < 5; i++) {
                const recruiter = recruiters[Math.floor(Math.random() * recruiters.length)];
                if (!topRecruiters.includes(recruiter)) {
                    topRecruiters.push(recruiter);
                }
            }
            
            return {
                averagePackage: avgPackage,
                highestPackage: highestPackage,
                placementRate: placementRate,
                topRecruiters: topRecruiters
            };
        }

        // Generate courses based on type
        function generateCourses(type) {
            if (type === 'Engineering') {
                return ['B.Tech', 'M.Tech', 'PhD', 'B.E.', 'M.E.'];
            } else if (type === 'University') {
                return ['BA', 'BSc', 'BCom', 'MA', 'MSc', 'MCom', 'PhD', 'B.Tech', 'M.Tech'];
            } else if (type === 'Medical') {
                return ['MBBS', 'MD', 'MS', 'BDS', 'MDS'];
            } else if (type === 'Management') {
                return ['BBA', 'MBA', 'PGDM', 'Executive MBA'];
            } else {
                return ['BA', 'BSc', 'BCom', 'MA', 'MSc', 'MCom'];
            }
        }

        // Search functionality
        function handleSearch() {
            const searchTerm = document.getElementById('search-input').value.trim();
            fetchColleges(searchTerm);
        }

        // Filter functionality
        function handleFilter(filterType) {
            currentFilter = filterType.toLowerCase();
            
            // Apply filter to existing data
            if (currentFilter === 'all') {
                filteredColleges = [...allColleges];
            } else {
                filteredColleges = allColleges.filter(college => {
                    if (currentFilter === 'university') {
                        return college.amenity === 'university' || college.name.toLowerCase().includes('university');
                    } else if (currentFilter === 'college') {
                        return college.amenity === 'college' || college.name.toLowerCase().includes('college');
                    } else if (currentFilter === 'institute') {
                        return college.name.toLowerCase().includes('institute');
                    } else if (currentFilter === 'school') {
                        return college.amenity === 'school' || college.name.toLowerCase().includes('school');
                    }
                    return true;
                });
            }
            
            // Update count and render
            document.getElementById('college-count').textContent = `${filteredColleges.length} colleges found`;
            renderCollegeList();
            
            // Close filter menu
            document.getElementById('filter-menu').classList.remove('active');
        }

        // Mobile toggle functionality
        function toggleMobileList() {
            const listContainer = document.getElementById('college-list-container');
            const toggleBtn = document.getElementById('mobile-toggle');
            
            if (listContainer.classList.contains('mobile-hidden')) {
                listContainer.classList.remove('mobile-hidden');
                toggleBtn.innerHTML = '<i class="fas fa-times"></i> Hide College List';
            } else {
                listContainer.classList.add('mobile-hidden');
                toggleBtn.innerHTML = '<i class="fas fa-list"></i> Show College List';
            }
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', () => {
            createParticles();
            fetchColleges(); // Auto-fetch colleges on page load
            
            // Search functionality
            document.getElementById('search-btn').addEventListener('click', handleSearch);
            document.getElementById('search-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleSearch();
            });
            
            // Real-time search with debounce
            let searchTimeout;
            document.getElementById('search-input').addEventListener('input', () => {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    const searchTerm = document.getElementById('search-input').value.trim();
                    if (searchTerm.length > 2 || searchTerm.length === 0) {
                        handleSearch();
                    }
                }, 1000);
            });
            
            // Filter functionality
            document.getElementById('filter-btn').addEventListener('click', () => {
                document.getElementById('filter-menu').classList.toggle('active');
            });
            
            document.querySelectorAll('.filter-option').forEach(option => {
                option.addEventListener('click', () => {
                    handleFilter(option.dataset.filter);
                });
            });
            
            // Mobile toggle
            document.getElementById('mobile-toggle').addEventListener('click', toggleMobileList);
            
            // Close filter menu when clicking outside
            document.addEventListener('click', (e) => {
                const filterDropdown = document.querySelector('.filter-dropdown');
                if (!filterDropdown.contains(e.target)) {
                    document.getElementById('filter-menu').classList.remove('active');
                }
            });
            
            // Handle window resize
            window.addEventListener('resize', () => {
                if (window.innerWidth > 768) {
                    document.getElementById('college-list-container').classList.remove('mobile-hidden');
                    document.getElementById('mobile-toggle').innerHTML = '<i class="fas fa-list"></i> Show College List';
                }
            });
        });

        // Scroll effects
        window.addEventListener('scroll', () => {
            const header = document.querySelector('.header');
            if (window.scrollY > 50) {
                header.style.background = 'rgba(255, 255, 255, 0.98)';
                header.style.boxShadow = '0 4px 40px rgba(0, 0, 0, 0.15)';
            } else {
                header.style.background = 'rgba(255, 255, 255, 0.95)';
                header.style.boxShadow = '0 4px 30px rgba(0, 0, 0, 0.1)';
            }
        });

        // Prevent zoom on double tap for iOS
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
    </script>
</body>
</html>